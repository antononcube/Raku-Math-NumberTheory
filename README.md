# Math::NumberTheory

Raku package with Number theory functions.

The function names and features follow the 
[Number theory functions of Wolfram Language](http://reference.wolfram.com/language/guide/NumberTheory.html).

**Remark:**  Raku has some nice built-in Number theory functions, like, `base`, `mod`, `polymod`, `expmod`, `is-prime`. 
They somewhat lack generality, hence their functionalities are extended with this package. 
For example, `is-prime` works with lists and [Gaussian integers](https://en.wikipedia.org/wiki/Gaussian_integer).

-------

## Installation

From [Zef ecosystem](https://raku.land):

```
zef install Math::NumberTheory
```

From GitHub:

```
zef install https://github.com/antononcube/Raku-Math-NumberTheory
```

-------

## Usage examples

### Prime number testing

The built-in sub `is-prime` is extended to work with [Gaussian integers](https://en.wikipedia.org/wiki/Gaussian_integer):

```perl6
use Math::NumberTheory;
say is-prime(2 + 1i);
say is-prime(5, :gaussian-integers);
```
```
# True
# False
```

Another extension is threading over lists of numbers:

```perl6
is-prime(^6)
```
```
# (False False True True False True)
```

### Factor integers

Gives a list of the prime factors of an integer argument, together with their exponents:

```perl6
factor-integer(factorial(20))
```
```
# [(2 18) (3 8) (5 4) (7 2) (11 1) (13 1) (17 1) (19 1)]
```

**Remark:** By default `factor-integer` uses [Pollard's Rho algorithm](https://en.wikipedia.org/wiki/Pollard's_rho_algorithm) --
specified with `method => 'rho'` --
as implemented at RosettaCode, [RC1], with similar implementations provided by "Prime::Factor", [SSp1], and "Math::Sequences", [RCp1].

Do partial factorization, pulling out at most `k` distinct factors:

```perl6
factor-integer(factorial(20), 3, method => 'trial')
```
```
# [(2 18) (3 8) (5 4)]
```


### Chinese reminders

Data:

```perl6
my @data = 931074546, 117172357, 482333642, 199386034, 394354985;
```
```
# [931074546 117172357 482333642 199386034 394354985]
```

Keys:

```perl6
#my @keys = random-prime(10**9 .. 10**12, @data.elems);
my @keys = 274199185649, 786765306443, 970592805341, 293623796783, 238475031661;
```
```
# [274199185649 786765306443 970592805341 293623796783 238475031661]
```

**Remark:** Using these larger keys is also a performance check.


Encrypted data:

```perl6
my $encrypted = chinese-reminder(@data, @keys);
```
```
# 6681669841357504673192908619871066558177944924838942629020
```

Decrypted:

```perl6
my @decrypted = @keys.map($encrypted mod *);
```
```
# [931074546 117172357 482333642 199386034 394354985]
```

### Power-mod

The sub `power-mod` extends the built-in sub `expmod`.
The sub `modular-inverse` is based on `power-mod`.

`expmod` gives an error and no result when the 1st argument cannot be inverted with the last argument:

```perl6
expmod(30, -1, 12)
```
```
#ERROR: Error in mp_exptmod: Value out of range
# Nil
```

`power-mod` returns `Nil`:

```perl6
power-mod(30, -1, 12).defined
```
```
# False
```

Also, `power-mod` 

### Number-base related

There are several subs that provide number system representation functionalities.

For examples, here we find the digit-breakdown of $100!$:

```perl6
100.&factorial.&digit-count
```
```
# {0 => 30, 1 => 15, 2 => 19, 3 => 10, 4 => 10, 5 => 14, 6 => 19, 7 => 7, 8 => 14, 9 => 20}
```

Here is an examples of using `real-digits`:

```perl6
real-digits(123.55555)
```
```
# ([1 2 3 5 5 5 5 5] 3)
```

Non-integer bases can be used:

```perl6
my $r = real-digits(π, ϕ);
```
```
# ([1 0 0 0 1 0 0 1 0 1 0 1 0 0 1 0 0 0 1 0 1 0 1 0 1 0 0 0 0 0 1 0 1 0 0 1 0 0 0 0 1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 1 0 1 0 1 0 1] 3)
```

Here we recover $\pi$ from the obtained Golden ratio representation:

```perl6
$r.head.kv.map( -> $i, $d { $d * ϕ ** ($r.tail - $i - 1)  }).sum;
```
```
# 3.141592653589543841932814656462308126319845312613598680607236543997607209715921372058992152853861012749773541821967893525312775171257939130668573083214100170913155007881003777433954103991667952797883843997392573997023379753049472625436016686036481688392504181533992673844690775804941199990635802237587461243262797500225859381356338701156800344953942350288759654878323319983592656471728186395822877646218511306727843222682244939745717031114286853178901828966890745477963766920484066227183042717968488409654301631236693512653533969087909783258627984744836050925628810948405352741975892105470354497943005114613504215221208205524939468701466366021597951575350932102011406341736814063876047639370782929872452657325707069448339384447651526045225818432421210575545611822693048394785895166512520780923531169171197112218446936970449471312843038169451210695480762780944033311899034182307281834579658076636619439352965578520315326349190603680464859105587365057072219385829219403288110709785490551462588904107095410523733182432202613629615533581451218083252227422744669380241448141769889266322432638579882045134826259267290985417406415870271628741835102572889526156548928324454710129267626923551068117486285036796880718311899326073384807025604273493357857858166852695689187369487263145686390542909650889804529416677818527255303186920143491306887215654642595291791138737974993945529017605183575859701389220921609815341305913602710459238046729613273281819629251406061556296192063586696266362494512081578448979446046757858022769943035274698374216300752099733286793167339365486576016804017039161561771287427367325263095469704246586491400997727774460336302512224911256414713512998611393362522732571799745699971194621226783672810369920481752184470500208641272089544059506878281966628957497885680749659034303644438102953155284580693716600767954441275903844558711492283996024257308537805299787465446674078921907431829844194792725881518638676383222367148750268909689264940258380096609683500656867607312242950110398288975892772606661158893010773895540929611754031339982482407802124552330526384648481848009289273595219708185883418255240219671667070917267690918401321561967497145458750529312802251086996853792168271197834566803142535128992167979388373537823973595693694831196094854678723140540218359911729708354632136841415235831603130054530118483613005349886444238389441704327131310832015668109570180180198376273422301509762744313452519278749472706029468393454312990954838072996139560022796786819997012927371796790261652487564968507732648851241266433991242930901277194609281171696034651265207772332105761691996448372344956988737803778437973707657653427494869057698205666315707426076619515257947939962727005254602667535525384594715218712700556808063001662405354994312046907087310830075755061671425819786513079311208223680490843709039448605250401581894551316384543169169006170901024546264170010168787271869953426338347436785094802571047896977400336015606006433272422314125563458618549584385187746195318560517598578797023492756761189184014771693785614998575247677217275646915724909376242874253889887476207569485845331955156755623665409948489240246546721014085252163726226136277026108007705047918567608175260458817839752934211260137452257970845455082589994419453506387274668118112149684578923563245294709310580128806883492457056695595675558298886320848761804865849688627443469089163975894428605003262193680638572058583310332426060047574932872605717694059354621631737983491968725709005903282575240017083010786978893244050886998414203727143018985852634536997796569907900753092747223919022455740743365936319191573984867205701494417949503364306817717291046056141504667090780998825962230845293465702035896029310839053081563370708065494333445946790606264306178572079151735016540701894755386456795093464564500584305312138999799053776000788068453165309307366702545042550769257625141021117099603400331158311429967278481203335640651494290964796340422639418592109218180464472557809594993641545980010750726903862839975938507500526760919175927099132734597225102978211546272135662808880533883813916110476490341944920975495862315021135050075052683406826017488665284460608881080313323807190831828822163703131946155669669013038049136897084885543063799545811168283459299969171709167353638208428196484645549945012644984692211707992751810955223283580384492128794665639642400076527454228637101502574090706458791284516569509939515837571576717573962269560353424305263623581435198774812516663624583628354372183920144724122666518620665658947196597380781567925395844799234425813198793777135747718426039568004826760644440865547890768458896908724040993157949290275326622423495341059273716488733741688984343983012721663648333209949754618718450544977091247888967548610527559694863730477558937138397965680023672220345730015116145528611229822141393739161861398204836802896385170897055742010757779760476798365065982836981346872648859243147149449224397161658613769365886118370216520430215141521928979861743264309014479543120756556084657051044146662456709145757924242757805763024670494011335004367647439086716715885116357216309634418436551297286821733542417226
```

The sub `phi-number-system` can be used to compute
[Phi number system](https://mathworld.wolfram.com/PhiNumberSystem.html)
representations:

```perl6
.say for (^7)».&phi-number-system
```
```
# ()
# (0)
# (1 -2)
# (2 -2)
# (2 0 -2)
# (3 -1 -4)
# (3 1 -4)
```

**Remark:** Because of the approximation of the Golden ratio used in “Math::NumberTheory”,
in order to get exact integers from phi-digits we have to round using small multiples of 10. 

-------

## References

[RC1] Rosetta Code, [Prime decomposition](https://rosettacode.org/wiki/Prime_decomposition),
[Section "Pure Raku"](https://rosettacode.org/wiki/Prime_decomposition#Pure_Raku).

[RCp1] Raku Community,
[Math::Sequences Raku package](https://github.com/raku-community-modules/Math-Sequences),
(2016-2024),
[GitHub/raku-community-modules](https://github.com/raku-community-modules).

[SSp1] Stephen Schulze,
[Prime::Factor Raku package](https://github.com/thundergnat/Prime-Factor),
(2016-2023),
[GitHub/thundergnat](https://github.com/thundergnat).
